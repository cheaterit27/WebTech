# functions.js

var getBonusedEmployees = function(employees,bonus){
    var bonusemployee = [];
    employees.forEach(function(item) {
        Object.keys(item).forEach(function(key1) {
            if(key1==="id")
            {               
                    Object.keys(bonus).forEach(function(key2) {
                      if(item[key1]===key2 && bonus[key2]){
                       //console.log("id:" + item["id"] + ",full name" + item["name"] + ",salary :" + item["salary"]);
                       bonusemployee.push({id:item["id"],fullname:item["name"],salary:(item["salary"]+item["yearsWorking"]*1000)});
                    }
                    });
                
            }
          
        });
    });
    return bonusemployee;
}

module.exports = {
    getBonusedEmployees: getBonusedEmployees
};


# promise (with bluebird will probably be asked not to do)

var utils = require("./functions");
var Promise = require("bluebird");
var fs = Promise.promisifyAll(require("fs"));

var file1 = fs.readFileAsync("employees.json");
var file2 = fs.readFileAsync("bonuses.json");
var bonusedemployees;
Promise.all([file1, file2]).spread(function(file1, file2) {
  file1 = JSON.parse(file1);
  file2 = JSON.parse(file2);
  bonusedemployees = utils.getBonusedEmployees(file1,file2);
  var logdata = JSON.stringify(bonusedemployees);
  console.log(logdata);

  var file3 = fs.writeFileAsync("bonusedEmployees.json",logdata);
  var file4 = fs.writeFileAsync("log.txt",logdata);

  Promise.all([file3, file4]).spread(function() {
    console.log("Data Write Complete");
  
  });
});





# promise code which we will probably use

"use strict";

var utils = require("./functions");

const {promises: {readFile}} = require("fs");

Promise.all([
  readFile("employees.json"),
  readFile("bonuses.json"),
  ]).then(([employee, bonuses]) => {
    var file1 = JSON.parse(employee);
    var file2 = JSON.parse(bonuses);
    var bonusedemployees = utils.getBonusedEmployees(file1,file2);

    console.log(bonusedemployees);
}).catch(error => {
  console.error(error.message);
  process.exit(1);
});




# promise one more version for precaution


var utils = require("./functions");

const fs = require('fs');

// Create a Promise-based version of fs.readFile
function readFilePromise(filePath, encoding = 'utf8') {
    return new Promise((resolve, reject) => {
        fs.readFile(filePath, encoding, (err, data) => {
            if (err) {
                return reject(err);
            }
            resolve(data);
        });
    });
}

// Create a Promise-based version of fs.writeFile
function writeFilePromise(filePath, data, encoding = 'utf8') {
    return new Promise((resolve, reject) => {
        fs.writeFile(filePath, data, encoding, (err) => {
            if (err) {
                return reject(err);
            }
            resolve(); // Resolve with no value on success
        });
    });
}

const inputFilePath1 = 'employees.json';
const inputFilePath2 = 'bonuses.json';
const outputFilePath1 = 'bonusedEmployees.json';
const outputFilePath2 = 'log.txt';
var file1,file2;
var bonusedemployees;
var logdata;

// First, write some content to input.txt
readFilePromise(inputFilePath1)
    .then((data) => {
    	file1 = JSON.parse(data);
        console.log('Successfully read from employees.json:',data);
        return readFilePromise(inputFilePath2);
    })
    .then((data) => {
    	file2 = JSON.parse(data);
        console.log('Successfully read from bonuses.json:', data);
      
        bonusedemployees = utils.getBonusedEmployees(file1,file2);
        logdata = JSON.stringify(bonusedemployees);
        
        return writeFilePromise(outputFilePath1,logdata);
    })
    .then(() => {
    	return writeFilePromise(outputFilePath2,logdata);
    })
    .then(() => {
        console.log('Content of log.txt:', logdata);
    })
    .catch((error) => {
        console.error('An error occurred:', error);
    });
